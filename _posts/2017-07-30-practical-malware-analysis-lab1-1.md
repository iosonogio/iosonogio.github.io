#Lab 1-1

> **1) Upload the files to [VirusTotal](http://www.virustotal.com) and view the reports. Does either file match any existing antivirus signatures?**

I chose to compute the hashes first and then make a search by that hashes on VirusTotal.

**Lab01-01.exe**

MD5:    ```bb7425b82141a1c0f7d60e5106676bb1```

SHA1:   ```9dce39ac1bd36d877fdb0025ee88fdaff0627cdb```

SHA256: ```58898bd42c5bd3bf9b1389f0eee5b39cd59180e8370eb9ea838a0b327bd6fe47```

**Lab01-01.dll**

MD5:    ```290934c61de9176ad682ffdd65f0a669```

SHA1:   ```a4b35de71ca20fe776dc72d12fb2886736f43c22```

SHA256: ```f50e42c8dfaab649bde0398867e930b86c2a599e8db83b8260393082268f2dba```

At present date VirusTotal reports both files as malicious:

The reports are available here:

[Lab01-01.exe](https://www.virustotal.com/en/file/58898bd42c5bd3bf9b1389f0eee5b39cd59180e8370eb9ea838a0b327bd6fe47/analysis/)

[Lab01-01.dll](https://www.virustotal.com/en/file/f50e42c8dfaab649bde0398867e930b86c2a599e8db83b8260393082268f2dba/analysis/)


> **2) When were these files compiled?**


Opening the files with [PEview](http://wjradburn.com/software/PEview.zip) reveals the compilation time by looking under: ```IMAGE_NT_HEADERS / IMAGE_FILE_HEADER / TimeDateStamp```

Lab01-01.exe: 2010/12/19 Sun 16:16:19 UTC
Lab01-01.dll: 2010/12/19 Sun 16:16:38 UTC


##3. Are there any indications that either of these files is packed or obfuscated?
If so, what are these indicators?

The files do not appear to be packed or obfuscated. I get an hint opening them with PEiD or ExeinfoPE.

Also an indication of neither of them being packed nor obfuscated is that both contains many readable strings.

###Strings

On Windows, you may use the [strings2](http://www.split-code.com/strings2.html) utility 

By the way, the strings2 utility is able to dump strings from a process memory address space, check it out!

```> strings2 Lab01-01.exe -nh```

Use the flags ```-a``` or ```-u``` to search only for ASCII or Unicode strings.

On Linux, use the strings utility.


##4. Do any imports hint at what this malware does? If so, which imports
are they?

IDA Pro
Dependency Walker
PEview
PeStudio
strings


##5. Are there any other files or host-based indicators that you could look for
on infected systems?

File:  Lab01-01.dll
File:  C:\windows\system32\kerne132.dll
Mutex: SADFHUHF


##6. What network-based indicators could be used to find this malware on
infected machines?


127.26.152.13



##7. What would you guess is the purpose of these files?



## Lab01-01.exe

From the strings output it doesn't seem that this executable is packed. 

There are some interesting strings to notice. A few are library functions that are called.
I can deduce that the malware is searching for files (FindFirstFile, FindNextFile), maybe those ending in .exe; it is creating and copying some file (CreateFile, CopyFile); it is getting a map of an existing file (MapViewOfFile) which it may be read from or write to.
Additionally it is using the DLL Lab01-01.dll which may be copied to kerne132.dll in C:\windows\system32\ (a name that resemble the legit kernel32.dll).

CloseHandle
UnmapViewOfFile
IsBadReadPtr
MapViewOfFile
CreateFileMappingA
CreateFileA
FindClose
FindNextFileA
FindFirstFileA
CopyFileA

kerne132.dll
.exe
C:\*
C:\windows\system32\kerne132.dll
Lab01-01.dll




## Lab01-01.dll

CloseHandle
Sleep
CreateProcessA
CreateMutexA
OpenMutexA

exec
sleep
hello

127.26.152.13
SADFHUHF

   

